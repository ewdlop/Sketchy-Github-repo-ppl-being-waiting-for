# ğŸƒ

ChatGPT: é€™è£¡æ˜¯å¹¾å€‹ã€Œè¬è–ç¯€ä¸»é¡Œã€çš„ **Sketchy SQL Queries**ï¼ˆè©­ç•°ã€ææ€ªåˆå¸¶é»é§­å®¢é¢¨æ ¼ï¼‰ğŸƒï¼Œç´”å±¬å¹½é»˜èˆ‡æ•™å­¸ç”¨é€”ï¼Œè«‹å‹¿åœ¨çœŸå¯¦ç”Ÿç”¢è³‡æ–™åº«ä¸ŠåŸ·è¡Œã€‚
æ‰€æœ‰ä¾‹å­å‡å®‰å…¨å¯æ¸¬è©¦ï¼ˆåªæŸ¥è©¢ä¸æ”¹è³‡æ–™ï¼‰ï¼Œä¸¦é™„ä¸Šè§£é‡‹ã€‚

---

## ğŸ§›â€â™‚ï¸ 1. æ‰¾å‡ºã€Œå¹½éˆç´€éŒ„ã€

```sql
SELECT *
FROM users
WHERE last_login IS NULL
  OR deleted_at IS NOT NULL;
```

**èªªæ˜**ï¼š
é€™äº›å¸³è™Ÿå¾æ²’ç™»å…¥éæˆ–æ—©å°±ã€Œè¢«åˆªé™¤ã€å»é‚„åœ¨è³‡æ–™åº«è£¡â”€â”€æœ€åƒã€Œå¹½éˆã€çš„å­˜åœ¨ã€‚

---

## ğŸ§™â€â™€ï¸ 2. è©›å’’è§¸ç™¼ç´€éŒ„

```sql
SELECT id, username, COUNT(*) AS curse_count
FROM logs
WHERE message LIKE '%forbidden%' OR message LIKE '%unauthorized%'
GROUP BY id, username
HAVING curse_count > 3;
```

**èªªæ˜**ï¼š
æ‰¾å‡ºå¤šæ¬¡è§¸ç™¼ã€Œç¦å¿Œã€æ“ä½œçš„ä½¿ç”¨è€…ã€‚
3 æ¬¡ä»¥ä¸Š = å·²ç¶“ä¸­äº† SQL è©›å’’ã€‚

---

## ğŸª¦ 3. å¾å¢³å¢“çˆ¬å‡ºçš„è³‡æ–™

```sql
SELECT *
FROM products
WHERE discontinued = 1
  AND DATEDIFF(DAY, deleted_at, GETDATE()) > 365;
```

**èªªæ˜**ï¼š
åˆ—å‡ºã€Œæ­»è€Œå¾©ç”Ÿã€è¶…éä¸€å¹´çš„å•†å“ã€‚
é©åˆç”¨ä¾†æ¸…ç†è³‡æ–™åº«çš„ã€Œæ®­å±è³‡æ–™ã€ã€‚

---

## ğŸ§Ÿâ€â™‚ï¸ 4. é€£çµå…©å€‹ä¸–ç•Œ

```sql
SELECT u.username, o.order_id
FROM users u
LEFT JOIN orders o ON u.id = o.user_id
WHERE o.user_id IS NULL;
```

**èªªæ˜**ï¼š
é€™æŸ¥è©¢æœƒæ‰¾åˆ°ã€Œæ²’æœ‰ä»»ä½•è¨‚å–®ã€çš„ä½¿ç”¨è€…ã€‚
ä»–å€‘å°±åƒåœ¨äººé–“è¡Œèµ°çš„ã€Œç„¡ä¸»é­‚ã€ã€‚

---

## ğŸ•¸ï¸ 5. èœ˜è››ç¶²æŸ¥è©¢ï¼ˆå¾ªç’°å¼•ç”¨ï¼‰

```sql
WITH RECURSIVE spider_web AS (
  SELECT id, parent_id, name
  FROM categories
  WHERE parent_id IS NULL
  UNION ALL
  SELECT c.id, c.parent_id, c.name
  FROM categories c
  JOIN spider_web s ON c.parent_id = s.id
)
SELECT * FROM spider_web;
```

**èªªæ˜**ï¼š
ç”¨éè¿´ CTE çˆ¬æ•´æ£µåˆ†é¡æ¨¹ã€‚
ä½†è‹¥è³‡æ–™å‡ºç¾å¾ªç’°ï¼ˆself-loopï¼‰ï¼Œé€™æŸ¥è©¢æœƒé™·å…¥ç„¡ç›¡çš„ã€Œèœ˜è››ç¶²ã€ã€‚

---

## ğŸ©¸ 6. éš±è—çš„è¡€è·¡ï¼ˆRed Flagsï¼‰

```sql
SELECT *
FROM transactions
WHERE amount < 0
  OR description LIKE '%error%'
  OR status IN ('failed', 'reversed');
```

**èªªæ˜**ï¼š
æŠ“å‡ºã€Œç•°å¸¸äº¤æ˜“ã€â”€â”€åƒè¡€è·¡ä¸€æ¨£çš„è­¦è¨Šã€‚
ç´…æ——ä¸åªæ˜¯ç¯€æ…¶é¡è‰²ã€‚

---

## ğŸƒ Bonusï¼šéš¨æ©Ÿå¬å–šä¸€ç­†è¨˜éŒ„

```sql
SELECT TOP 1 *
FROM victims -- å‘ƒâ€¦å‡è¨­é€™æ˜¯å€‹ Halloween Table åç¨±
ORDER BY NEWID();
```

**èªªæ˜**ï¼š
æ¯æ¬¡åŸ·è¡Œéƒ½éš¨æ©Ÿå¬å–šä¸€ç­†è³‡æ–™ã€‚
ä½ æ°¸é ä¸çŸ¥é“æœƒå«å‡ºèª°ã€‚

---

ğŸ“š **åƒè€ƒè³‡æ–™**ï¼š

* Microsoft Docs â€“ [Transact-SQL Reference](https://learn.microsoft.com/en-us/sql/t-sql/language-reference)
* PostgreSQL Documentation â€“ [SQL Syntax and CTEs](https://www.postgresql.org/docs/current/queries-with.html)
* OWASP â€“ [SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)

---

æ˜¯å¦æƒ³è¦æˆ‘æ¥è‘—å¹«ä½ ç”Ÿæˆã€Œ**ææ€– SQL Injection å¯¦ä¾‹ï¼ˆæ•™è‚²ç”¨ï¼‰**ã€å’Œã€Œ**é˜²ç¦¦æ‰‹æ³•**ã€ç‰ˆæœ¬ï¼Ÿå¯åšæˆä¸€ç¯‡ Halloween æŠ€è¡“æ–‡ç« é¢¨æ ¼ã€‚
